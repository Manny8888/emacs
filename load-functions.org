This is a file to store some miscellaneous functions I use every now
and then. 

* Jekyll functions
I use ~jekyll-publish-draft~ to move a post from _drafts/ to _posts/
which publishes it to my blog. Inspiration from [[http://pasoev.github.io/programming/2015/10/31/jekyll-posts-emacs-capture/][here]]

#+BEGIN_SRC emacs-lisp
  (defun today-is ()
    "Return current year-month-day."
    (format-time-string "%Y-%m-%d"))

  (defun jekyll-drafts ()
    (let ((default-directory
            (concat (projectile-project-root) "_drafts")))
    (file-expand-wildcards "*.md")))

  (defun jekyll-publish-draft (post)
    "Mark one of the posts from the Jekyll drafts directory as published.
     This actually means moving the post from the _drafts to the _posts 
     directory."
    (interactive
     (list (completing-read "Post to publish: "
                            (jekyll-drafts) nil t "")))
    (copy-file (concat (projectile-project-root) "_drafts/" post)
               (concat (projectile-project-root) "_posts/" (today-is) "-" post))
    (delete-file (concat (projectile-project-root) "_drafts/" post)))

#+END_SRC

* Sudo editing
This function lets me edit the current file as root. Note that I can
also edit files as root when using helm find files by simply using
~C-c r~ in the buffer. So I use this to edit the already-open file as
root and then helm to open files as root. [[http://emacsredux.com/blog/2013/04/21/edit-files-as-root/][source for this function]]

#+BEGIN_SRC emacs-lisp
  (defun sudo-edit (&optional arg)
    "Edit currently visited file as root.

  With a prefix ARG prompt for a file to visit.
  Will also prompt for a file to visit if current
  buffer is not visiting a file."
    (interactive "P")
    (if (or arg (not buffer-file-name))
        (find-file (concat "/sudo:root@localhost:"
                           (ido-read-file-name "Find file(as root): ")))
      (find-alternate-file (concat "/sudo:root@localhost:" buffer-file-name))))
#+END_SRC
